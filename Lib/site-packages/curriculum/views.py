"""
Views that can used by developer for easily export resume as PDF.
"""
from django.shortcuts import render
from django.http import HttpResponse
from django.shortcuts import get_object_or_404

from curriculum import export
from curriculum.models import Resume
from django.template.loader import get_template
from curriculum.forms import LanguageForm, LanguageItemForm, ResumeForm, SkillForm, SkillItemForm, CertificationForm, CertificationItemForm, ExperienceForm, ProjectForm, ProjectItemForm, TrainingForm


def export_single_page(request):
    """Get a resume in a single page PDF."""
    resume = get_object_or_404(Resume.objects.filter(firstname='Mahesh'))
    pdf, result = export.export_pdf(resume, export.single_page)
    raw_pdf = result.getvalue()
    if not pdf.err:
        return HttpResponse(raw_pdf, content_type='application/pdf')
    return HttpResponse('We had some errors.')

def export_classic(request):
    """Get a resume in a PDF with classic format."""
    #resume = get_object_or_404(Resume.objects.filter(id=resume_id))
    resume = get_object_or_404(Resume.objects.filter(firstname='Vijay'))
    pdf, result = export.export_pdf(resume, export.classic)
    raw_pdf = result.getvalue()
    if not pdf.err:
        return HttpResponse(raw_pdf, content_type='application/pdf')
    return HttpResponse('We had some errors.')

def export_classic1(request):
    """Get a resume in a PDF with classic format."""
    #resume = get_object_or_404(Resume.objects.filter(id=resume_id))
    resume = get_object_or_404(Resume.objects.filter(firstname='Vijay'))
    pdf, result = export.export_pdf(resume, export.classic1)
    raw_pdf = result.getvalue()
    if not pdf.err:
        return HttpResponse(raw_pdf, content_type='application/pdf')
    return HttpResponse('We had some errors.')


def export_class(request, first_name):
    """
    Create a classic resume in :mod:`xhtml2pdf` format.
    """
   # resume = get_object_or_404(Resume.objects.filter(firstname='Vijay'))
    resume=Resume.objects.get(firstname=first_name)
    context = {
        'pagesize': 'a4',
        'resume': resume,
        'skills': resume.skills.order_by('category', '-weight'),
        'projects': resume.projects.order_by('-weight'),
        'experiences': resume.experiences.order_by('-start_year'),
        'trainings': resume.trainings.order_by('-year', '-month'),
        'certifications': resume.certifications.order_by('-start_year', '-start_month'),
    }
   # return get_template('curriculum/test1.html').render(context)
    return render(request,'curriculum/cvpreview.html',context)
"""
def skillitem(request):
    if request.method=="POST":
        form=ExperienceForm(request.POST)
        if form.is_valid():
            try:
                form.save()
                return redirect()
            except:
                pass
    else:
        form=ExperienceForm()
    return render(request,"producttemp.html",{'form':form})
"""

def addlanguage(request):
    form=TrainingForm(request.POST or None)
    if form.is_valid():
        form.save()

    context={
        'form':form
    }
    return render(request,"curriculum/language.html",context)

def addlanguageitem(request):
    form=LanguageItemForm(request.POST or None)
    if form.is_valid():
        form.save()

    context={
        'form':form
    }
    return render(request,"curriculum/languageitem.html",context)

def addresume(request):
    form=ResumeForm(request.POST or None, request.FILES)
    if form.is_valid():
        form.save()

    context={
        'form':form
    }
    return render(request,"curriculum/resume.html",context)

def addskill(request):
    form=SkillForm(request.POST or None, request.FILES)
    if form.is_valid():
        form.save()

    context={
        'form':form
    }
    return render(request,"curriculum/skill.html",context)

def addskillitem(request):
    form=SkillItemForm(request.POST or None, request.FILES)
    if form.is_valid():
        form.save()

    context={
        'form':form
    }
    return render(request,"curriculum/skillitem.html",context)

def addcertification(request):
    form=CertificationForm(request.POST or None, request.FILES)
    if form.is_valid():
        form.save()

    context={
        'form':form
    }
    return render(request,"curriculum/certification.html",context)

def addcertificationitem(request):
    form=CertificationItemForm(request.POST or None, request.FILES)
    if form.is_valid():
        form.save()

    context={
        'form':form
    }
    return render(request,"curriculum/certificationitem.html",context)

def addexperience(request):
    form=ExperienceForm(request.POST or None, request.FILES)
    if form.is_valid():
        form.save()

    context={
        'form':form
    }
    return render(request,"curriculum/experience.html",context)

def addproject(request):
    form=ProjectForm(request.POST or None, request.FILES)
    if form.is_valid():
        form.save()

    context={
        'form':form
    }
    return render(request,"curriculum/project.html",context)

def addprojectitem(request):
    form=ProjectItemForm(request.POST or None, request.FILES)
    if form.is_valid():
        form.save()

    context={
        'form':form
    }
    return render(request,"curriculum/projectitem.html",context)

def addtraining(request):
    form=TrainingForm(request.POST or None, request.FILES)
    if form.is_valid():
        form.save()

    context={
        'form':form
    }
    return render(request,"curriculum/training.html",context)

def menulist(request,*args,**kwargs):
    return render(request,"curriculum/menulist.html",{})


